<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>座席抽選アプリ（6×6）</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1, h2 { margin: 0 0 10px; }
    #students button {
      margin: 4px; padding: 6px 10px; border: 1px solid #ccc; background: #f8f8f8; cursor: pointer;
    }
    #students button.selected {
      background: #2d7ff9; color: #fff; border-color: #2d7ff9;
    }
    #students button.assigned {
      background: #aaa; color: #fff; cursor: not-allowed;
    }
    table { border-collapse: collapse; margin-top: 10px; }
    td {
      width: 90px; height: 40px;
      text-align: center; border: 1px solid #ccc;
      cursor: pointer; user-select: none;
    }
    td.inactive { background-color: #eee; color: #999; }
    td.assigned { background-color: #cfe9cf; }
    td.highlight { background-color: yellow; }
    .controls { margin: 10px 0; }
    .hint { color: #666; font-size: 0.9em; }
    #result { font-size: 2.5em; margin-top: 15px; }
  </style>
</head>
<body>
  <a href="seito.html">➡ 生徒名登録ページへ</a>　
  <h1>座席抽選アプリ（6×6）</h1>

  <p class="hint">1) 自分の出席番号をクリック → 2) 「座席番号を抽選」を押す → 3) 出た番号の座席に割当て。席セルをクリックすると使用可/不可を切り替えできます。</p>

  <h2>出席番号をクリックしてください</h2>
  <div id="students"></div>
  <p id="result"></p>

  <h2>座席表（6×6）</h2>
  <table id="seatMap"></table>

  <div class="controls">
    <button id="drawBtn">座席番号を抽選</button>
    <button id="resetBtn">抽選をリセット</button>
    <label style="margin-left:12px;">
      <input type="checkbox" id="toggleMode"> 座席のON/OFF切替モード
    </label>
  </div>

  <script>
    const rows = 6, cols = 6;

    // seatStatus: true=使用、false=未使用
    let seatStatus = Array.from({ length: rows }, () => Array(cols).fill(true));
    const savedStatus = localStorage.getItem("seatStatus"); // ✅ 元に戻す
    if (savedStatus) {
      try {
        const parsed = JSON.parse(savedStatus);
        if (Array.isArray(parsed) && parsed.length === rows) seatStatus = parsed;
      } catch (e) {}
    }

    // 生徒一覧
    let studentsData = [];
    const savedStudents = localStorage.getItem("studentList"); // ✅ 元に戻す
    if (savedStudents) {
      try {
        const parsed = JSON.parse(savedStudents);
        if (Array.isArray(parsed) && parsed.length > 0) studentsData = parsed;
      } catch (e) {}
    }
    if (studentsData.length === 0) {
      studentsData = Array.from({ length: rows * cols }, (_, i) => [String(i + 1), String(i + 1)]);
    }

    // 特定配置
    let fixedSeats = [];
    const savedFixed = localStorage.getItem("fixedSeats"); // ✅ 元に戻す
    if (savedFixed) {
      try { fixedSeats = JSON.parse(savedFixed); } catch (e) {}
    }

    // …（以下の抽選処理やリセット処理はそのまま）
  </script>
</body>
</html>
